<!DOCTYPE html>
<html>
<head>
  <title>Tutorial Atelier Android</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="bootstrap-theme.min.css" />
  <link rel="stylesheet" href="bootstrap.min.css" />
  <link rel="stylesheet" href="my-theme.css" />
</head>

<body>
	<h1>Tutorial Atelier Android</h1>

	<hr/>
	<h2>Installations</h2>

	<ol>
		<li>Installer Virtual box: <strong>VirtualBox-4.3.12-93733-Win.exe</strong></li>
		<li>Si l'installation demande de redémarrer, redémarrer.</li>
		<li>Double cliquer sur <strong>Mint32.ova</strong> : ça lance une machine virtuelle</li>
		<li>Une fois le système d'exploitation lancé, le mot de passe est "angie"</li>
	</ol>
 
	<div class="rem"><strong>Remarque:</strong> la machine virtuelle simule un nouveau système d'exploitation sur votre ordinateur. Elle vous permet d'avoir quasiment aucune installation à faire pour démarrer. Par contre, le défaut c'est que ça risque de "ramer" un peu.</div>

	<h2>Lancements</h2>
	<ol>
		<li>Sur le bureau, double cliquer sur <img src="img/icone_emulateur.png"> pour lancer l'émulateur.</li>
		<li><strong>Attendez la fin du lancement</strong> de l'émulateur de téléphone jusqu'à l'écran permettant de déverouiller ci-contre :
		<img style="width:20em" src="img/emulateur_screenlock.png">
		</li>
		<li>Sur le bureau, double cliquer sur  <img src="img/icone_studio.png"> pour lancer l'interface de développement.</li>

		<li>Une fois l'interface lancée, cliquez sur la flèche verte pour lancer l'application Android sur le téléphone

			<img src="img/lancer_projet.png"/>
		</li>
	</ol>

	<p>Vous êtes prêt à développer !</p>

	<pre>Remarque: l'émulateur de téléphone étant assez long a se lancer, il est conseillé de ne pas le fermer. Si vous souhaitez utiliser un téléphone Android, vous pouvez vous rendre en fin de tutorial et suivre la procédure détaillée.</pre>

	<h2>Description de l'environnement de développement</h2>

	<img src="img/tour_studio.png">

	<ol>
		<li>Lancement de l'application Android sur l'émulateur. L'émulateur ne passe pas au premier plan, pensez à changer de fenetre pour voir le résultat (alt+tab).</li>
		<li>Explorateur du projet : cette partie vous permet de naviguer parmi l'ensemble des fichiers composant le projet. Un double click permet d'ouvrir un fichier dans la zone principale (3).</li>
		<li>La zone principale : c'est ici que vous allez écrire des lignes de code ou modifier l'interface graphique de votre application.</li>
	</ol>

	<pre>Remarque: si vous êtes sur un PC/Mac portable et que votre écran vous semble petit, vous pouvez double cliquer sur l'onglet pour afficher l'éditeur de code / de vue en pleine page (et re-double cliquer pour revenir à la vue normale)</pre>

	<h2>Atelier</h2>

	<p>L'environnement de développement est prêt, on entre maintenant dans le vif du sujet : faire une application Android.
	<br/>
	Vous avez à disposition un squelette d'un jeu de mémory : c'est un jeu où l'on retourne les cartes 2 par 2 et où il faut retrouver les paires. Une fois toutes les paires trouvées, c'est gagné.
	<br/>

	<hr/>
	<h3>1ère étape: Ajouter deux cartes</h3>
	Ouvrir Memory &gt; app &gt; src &gt; main &gt; res &gt; layout &gt; <strong>activity_ecran_memory.xml</strong>
	<img src="img/editeur_graph.png">

	<h4>Description de l'éditeur:</h4>

	<ol>
		<li>Elements de mise en page : permettent de positionner les différents éléments graphiques (boutons, images...etc).</li>
		<li>Elements graphiques : images, boutons, textes, etc.</li>
		<li>Vue graphique/vue texte : l'interface graphique Android est en fait basée sur un fichier texte, l'écran "Design" permet de créer l'interface graphique en glissant/dépossant les composants graphiques : le fichier texte détaillant l'interface graphique est généré. Il est possible de modifier directement ce fichier texte dans l'onglet "Text".</li>
		<li>Arborescence des éléments : la vue graphique fonctionne avec un système de container : une vue principale est composée de plusieurs sous-vues, etc.</li>
		<li>Propriété de l'élément graphique sélectionné : chaque composant a des propriétés, comme la taille, la couleur, l'image de fond, etc.</li>
	</ol>

	<h4>Ajout des cartes pas à pas:</h4>
	<ol>
		<li>Dans la palette, chercher l'élément "Linear layout (Horizontal)".</li>
		<li>Le glisser sur le "linear Layout (vertical)" dans l'arborescence des éléments
			<img src="img/glisser_linear_layout.png">
			<br/>
			<br/>Vous devez obtenir :
			<img src="img/resultat_linear_layout.png">

		</li>
		<li>Glisser 2 image view dans le line layout que vous venez d'ajouter.</li>
		<li>Ajouter les spaces.</li>
		<li>Renommer les id des 2 imageView et mettre width="100 dip"  height="100 dip"</li>
		<li>Dans le linear layout, ajouter gravity "center_horizontal"; et changer "fill_parent" par "wrap_content"</li>
		<li>Sur les imageView, dans src mettre "@drawable/dos2"</li>

	</ol>

	<h4>Voici ce que vous devez obtenir en vue Design</h4>
	<img src="img/resultat_ajout_vues.png">

	<h4>Voici ce que vous devez obtenir en vue Text</h4>
<pre>
&lt;Space
    android:layout_width="20px"
    android:layout_height="20px" /&gt;

&lt;LinearLayout
    android:orientation="horizontal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"&gt;

    &lt;ImageView
        android:layout_width="100dip"
        android:layout_height="100dip"
        android:id="@+id/emplacement5View"
        android:src="@drawable/dos2" /&gt;

    &lt;Space
        android:layout_width="20px"
        android:layout_height="20px" /&gt;

    &lt;ImageView
        android:layout_width="100dip"
        android:layout_height="100dip"
        android:id="@+id/emplacement6View"
        android:src="@drawable/dos2" /&gt;
	&lt;/LinearLayout&gt;
</pre>

	<h4>Intégrer les 2 cartes au code</h4>
	Vous avez modifié l'aspect graphique, il faut maintenant gérer les évènements (clic sur une carte).

	Pour ce faire, ouvrir Memory &gt; app &gt; src &gt; main &gt; java &gt; com.atelier.angie.Memory &gt; <strong>EcranMemoryActivity</strong>

	<h4>Quelques bases de code Java</h4>

	<ul>
		<li>Les "//" et "/* ... */" sont des commentaires : ces lignes ne seront pas executées.</li>
		<li>L'ordinateur n'aime pas les accents, les caractères spéciaux et les espaces : vous pouvez nommer vos objets en français, mais unPeuCommeCa.</li>
		<li>Les accolades "{" et "}" permettent de définir des blocks : c'est à dire un ensemble d'instructions qui seront executées les unes à la suite des autres.</li>
		<li>Dans le fichier vous avez un block qui engloble l'ensemble :
<pre>
	public class EcranMemoryActivity extends Activity {
	...
	}
</pre>

	puis des sous-block appelés aussi méthodes, par exemple :
<pre>
	protected void onCreate(Bundle savedInstanceState) {
        ...
    }

    private void initierLePlateauDeJeu(){
    ...
	}
</pre>
		</li>
		<li>On peut appeler une méthode dans une autre méthode : le programme va éxécuter les lignes avant la méthode, puis les lignes de la méthode appelée à l'intérieur, puis les lignes après la méthode.</li>
		<li>Il y a des blocks un peu spéciaux:
			<ul><li>if = si: permet de faire des conditions, "si tu ne manges pas tes haricots, alors je ne te donne pas de glace"
<pre>if(carteGagnee.size()==NOMBRE_D_EMPLACEMENTS){
    trace("Gagné !");
    afficherPopupGagne();
}

Si le nombre de cartes retournées coté face est égale au nombre d'emplacements sur le jeu, alors toutes les cartes sont retournées, donc c'est gagné.
</pre>

			</li>
				<li>for = pour: pour faire une action identique pour un ensemble d'éléments : "pour toutes les cartes de mon tableau, les tourner"
<pre>for(ImageView emplacement: listeEmplacements){
	emplacement.setAlpha(1.0f);
	emplacement.setImageResource(IMAGE_DOS);
}

Pour toutes les images des emplacements, mettre de la transparence, et afficher le dos de la carte.
</pre>
				</li>
			</ul>
		</li>

	</ul>

	<h4>Ajout des cartes dans le code, pas à pas</h4>
	<ol>
		<li>Indiquer qu'il y a maintenant 6 cartes:
<pre>private static final int NOMBRE_D_EMPLACEMENTS=<span class="change">6</span>;</pre>
		</li>

		<li>Indiquer les images qui ont été ajoutées au layout qui correspondent à ses emplacements. Attention, <strong>l'ordinateur commence à compter à partir de 0</strong> et l'être humain commence à 1, c'est pour ça qu'il y a un léger décalage entre l'id de l'image et son numéro d'emplacement dans le code.
<pre>
private void initierLePlateauDeJeu(){

//Lien avec les composants graphiques de la vue activity_ecran_memory.xml
//Les 4 cases sont enregistrées dans une liste et le click sur la case est écouté.
listeEmplacements[0]=(ImageView)findViewById(R.id.emplacement1View);
listeEmplacements[0].setOnClickListener(quandJeToucheLEmplacement(0));
listeEmplacements[1]=(ImageView)findViewById(R.id.emplacement2View);
listeEmplacements[1].setOnClickListener(quandJeToucheLEmplacement(1));
listeEmplacements[2]=(ImageView)findViewById(R.id.emplacement3View);
listeEmplacements[2].setOnClickListener(quandJeToucheLEmplacement(2));
listeEmplacements[3]=(ImageView)findViewById(R.id.emplacement4View);
listeEmplacements[3].setOnClickListener(quandJeToucheLEmplacement(3));

<span class="change">listeEmplacements[4]=(ImageView)findViewById(R.id.emplacement5View);
listeEmplacements[4].setOnClickListener(quandJeToucheLEmplacement(4));
listeEmplacements[5]=(ImageView)findViewById(R.id.emplacement6View);
listeEmplacements[5].setOnClickListener(quandJeToucheLEmplacement(5));</span>
</pre>
		</li>
		<li>Choisir la face de carte supplémentaire, et ajouter les 2 cartes créées à la liste de cartes.
<pre>//Création des cartes qui seront ensuite distribuées sur les emplacements
Carte carte1 = new Carte(R.drawable.robot1);
Carte carte2 = new Carte(R.drawable.robot2);
Carte carte3 = new Carte(R.drawable.robot1);
Carte carte4 = new Carte(R.drawable.robot2);
<span class="change">Carte carte5 = new Carte(R.drawable.robot3);
Carte carte6 = new Carte(R.drawable.robot3);</span>

listeCarte.add(carte1);
listeCarte.add(carte2);
listeCarte.add(carte3);
listeCarte.add(carte4);
<span class="change">listeCarte.add(carte5);
listeCarte.add(carte6);</span>
</pre>
		</li>Testez, ça devrait marcher !</li>
	</ol>

	<hr/>
	<h1>Pour aller plus loin</h1>
	Vous êtes arrivé jusqu'ici : félicitations ! Voici maintenant quelques idées pour aller plus loin dans votre découverte.

	<h3>2ème étape: Changer les images des cartes</h3>
	Changez les images de face des cartes, ainsi que l'image de dos.
	<div class="rem">Les images utilisées dans l'application sont dans le dossier src/main/res/drawable; attention à nommer les images sans accent et sans espace !</div>
	<hr/>
	<h3>3ème étape: Ajouter un compteur de coup</h3>
	Ajoutez sur l'écran, une zone de texte dans laquelle vous comptez le nombre de cartes retournées pour gagner.

	<hr/>
	<h3>4ème étape: Afficher des scores dans un autre écran</h3>
	Ajoutez une nouvelle vue, c'est à dire un layout xml + une classe Activity, dans laquelle vous affichez les scores obtenus.

	<hr/>
	<h3>5ème étape: 2 joueurs avec score au coup par coup</h3>


	<hr/>
	<hr/>
	<h1>Annexes</h1>

	<h3>Utiliser un téléphone Android pour tester</h3>

</body>